<!doctype html><html lang=ja-jp><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.85.0"><title>ABC122 D - We Like AGC</title><link rel=canonical href=https://raahii.me/posts/abc122/><meta name=robots content="noindex"><meta http-equiv=refresh content="0; url=https://raahii.me/posts/abc122/"><link href=https://raahii.github.io/favicon.ico rel=icon type=image/x-icon><meta property="description" content="ABC122のD問題の解法メモ"><meta property="og:title" content="ABC122 D - We Like AGC"><meta property="og:description" content="ABC122のD問題の解法メモ"><meta property="og:type" content="article"><meta property="og:url" content="https://raahii.github.io/posts/abc122/"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-04-03T23:43:42+09:00"><meta property="article:modified_time" content="2019-04-03T23:43:42+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ABC122 D - We Like AGC"><meta name=twitter:description content="ABC122のD問題の解法メモ"><link rel=icon href=https://raahii.github.io/images/favicon.ico type=image/x-icon><link rel=stylesheet href=https://raahii.github.io/css/main.css media=all><link rel=stylesheet href="//fonts.googleapis.com/css?family=Merriweather:400|Lato:400,400italic,700"></head><body><div class=wrapper><header class=header><nav class=nav><a href=https://raahii.github.io/ class=nav-logo><img src=https://raahii.github.io/images/bird.svg width=45 height=45 alt=Logo><p class=nav-title>1ミリもわからん</p></a><ul class=nav-links><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=https://github.com/raahii target=_blank>GitHub</a></li><li><a href=https://twitter.com/raahiiy target=_blank>Twitter</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>ABC122 D - We Like AGC</h1><span class=article-date>April 3, 2019</span>
<span class=article-duration>1 min read</span><ul class="cp_tag01 article-categories">Categories:<li><a href=/categories/%E6%8A%80%E8%A1%93/>技術</a></li></ul><ul class="cp_tag01 article-tags">Tags:<li><a href=/tags/%E7%AB%B6%E3%83%97%E3%83%AD/>競プロ</a></li><li><a href=/tags/golang/>golang</a></li></ul><div class=article-content><p>前回のコンテスト，<a href=https://atcoder.jp/contests/abc122>ABC122</a>の復習メモを残しておく．</p><h1 id=問題>問題</h1><h2 id=問題文>問題文</h2><p>整数 $N$ が与えられます。次の条件を満たす長さ $N$ の文字列の数を $10^9$ で割った余りを求めてください。</p><ul><li><code>A</code>, <code>C</code>, <code>G</code>, <code>T</code> 以外の文字を含まない。</li><li><code>AGC</code> を部分文字列として含まない。</li><li>隣接する 2 文字の入れ替えを 1 回行うことで上記の条件に違反させることはできない。</li></ul><h2 id=制約>制約</h2><ul><li>$3\leq N\leq100$</li></ul><h1 id=解法考え方>解法（考え方）</h1><p>単純な全探索の計算量は $O(4^N)$ ．しかし「隣り合う文字列を入れ替えた時に"AGC"を含んではいけない」という制約は，新しくi番目の文字を決定するには<strong>直前の3文字のみが関与する</strong>ことがわかる．</p><p>ダメなケースというのは例えば</p><ul><li>3文字: &ldquo;AGC&rdquo;, &ldquo;GAC&rdquo;, &ldquo;ACG&rdquo;</li></ul><ul><li>4文字: &ldquo;A?GC&rdquo;, &ldquo;AG?C&rdquo;</li></ul><p>であるが，コツとして，文字列が制約を守っているかどうかを↑のように自分でパターンを書き出しすのではなく，プログラムしてあげるほうが良いということ（<a href=https://img.atcoder.jp/abc122/editorial.pdf>公式の解答</a>でやられている）．こういう感じ．</p><script type=application/javascript src=https://gist.github.com/raahii/1f5d88bda3ec4b09e26aeb55b48f3ca8.js></script><p>これがまた，Goだと <code>string</code> は要素の入れ替えができなくて辛い感じになるのですが笑（まぁ全角文字が入ったりすると<code>string</code>の要素はきちんと1文字に対応しないので，できない方が良いとも言える？）．</p><p>あとはオーバーフローするので余りを取ることを忘れないようにすること．dpテーブルの構築時，最後の和を取る部分の両方で使う．</p><h1 id=dpによる解法>DPによる解法</h1><p>解法の方向性がわかったところで，DPで解く方法を考える．この場合，i番目に文字jを採用できる場合の数をテーブルに埋めていく．</p><p>制約の全くない単純な数え上げをするケースをまず考えると，遷移式は</p><p>$$ dp[i+1][j] = \sum_{k} dp[i][k] $$</p><p>のように書くことができ，コードは次のようになる．</p><script type=application/javascript src=https://gist.github.com/raahii/3a69a715536f5e451e9bc3c491632590.js></script><p>この基本形を意識しながら，直前の3文字の状態を保持するためにテーブルを <code>dp[i][j][k][l]</code> のように拡張する．添字はそれぞれ直近3番目(<code>j</code>)，直近2番目(<code>k</code>)，直近1番目(<code>l</code>)を示す．そうすると遷移式は次のようにかける．</p><p>$$
dp[i+1][k][l][m] = \sum_{j,k,l}dp[i][j][k][l]
$$</p><p>ここで，<code>j</code> <code>k</code> <code>l</code> <code>m</code> の4つの文字を並べたときに，先の<code>ok</code>に渡して<code>true</code>となるもののみを遷移可能として足せば良い．dpを使うことで計算量は $O(N)$ になる．for文が多くて結構つらいが完成してみると難しいところは特にない．初期値をどうするかは割と迷った．</p><script type=application/javascript src=https://gist.github.com/raahii/019732bf3d8bccd5a0a8f2764a5d4169.js></script><h1 id=メモ化による解法>メモ化による解法</h1><p>これは模範解答のpdfと同じなので改めて説明する必要もないけれど，自分で理解する用で書いてみた．メモ化の方が再帰を使うのですっきり書ける．</p><script type=application/javascript src=https://gist.github.com/raahii/ea62641e1f2ba6d9cbfa6aac777914e8.js></script><h1 id=感想>感想</h1><p>この手の問題は経験値な気がする．解けるようになるのは楽しいけど，きちんと各解法を理解して，何故これで高速化できるのか，どれくらい高速化されるのかを説明できなければ，実務ではかすりもしない気がする．精進．</p></div></article><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//raahii.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a><h3>こちらの記事もどうぞ</h3><ul class="related-content article-content"><li><a href=/posts/permutations-in-go/>Goで順列（permutation）を実装する</a></li><li><a href=/posts/divisor-enumeration/>約数の全列挙の高速化</a></li><li><a href=/posts/union-find/>Union FindのメモとGoによる実装</a></li><li><a href=/posts/optional-parameters-in-go/>Goでオプショナルパラメータをどう扱うか</a></li><li><a href=/posts/aircon-timer-with-google-home-and-nature-remo/>Google HomeとNature Remoでエアコンのタイマーを快適にセットする</a></li></ul></main><footer class=footer><ul class=footer-links><li><a href=https://gohugo.io/ class=footer-links-kudos>Made with <img src=https://raahii.github.io/images/hugo-logo.png width=22 height=22 alt="hugo log"></a></li></ul></footer></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D4N0KPT2K2"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-D4N0KPT2K2',{anonymize_ip:!1})}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css integrity=sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js integrity=sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></body></html>